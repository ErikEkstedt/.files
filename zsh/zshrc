# ==== ZSHRC ====
# (K)Ubuntu 16.04, 17.10, 18.04

case `uname` in
  Darwin)
    # commands for OS X go here
    export LC_ALL=en_US.UTF-8
    export LANG=en_US.UTF-8
    ;;
  Linux)
    # commands for Linux go here
    stty -ixon # C-s, C-q 
    ;;
  FreeBSD)
    # commands for FreeBSD go here
    ;;
esac

# Settings {{{
# Uncomment the following line to disable auto-setting terminal title.
DISABLE_AUTO_TITLE="true"
# if you do a 'rm *', Zsh will give you a sanity check!
setopt RM_STAR_WAIT

#allows to type Bash style comments in the command line
setopt interactivecomments 

# zmodload zsh/zprof # see time and processes
# }}}

#==== Export {{{

export KEYTIMEOUT=1
# export TERM="xterm-256color"  # "xterm-256color"
# export TERM="xterm-kitty"
# export TERM="screen.xterm-256color"
export TERM="screen-256color"  # "xterm-256color"
export COLORTERM="truecolor"

export EDITOR='nvim'
export USE_EDITOR=$EDITOR
export VISUAL=$EDITOR
export BROWSER="firefox"   # google-chrome
export LANG=en_US.UTF-8
export DOTFILES="$HOME/.files"

## Conda / Python / Node Envs
export PATH=$HOME/miniconda3/bin:${PATH}
export PATH=$HOME/.node_modules_global/bin:${PATH}
export PATH=$HOME/.local/bin:${PATH}
export PATH=$HOME/.files/bin:${PATH}  # For my custom scripts

# export PYTHONPATH=$HOME/.files/pythonpath

# Geckodriver (selenium, webdriver for firefox)
export PATH=$HOME/geckodriver:${PATH}  # Download tar file and extract here 
# Kaggle
export KAGGLE_USERNAME=erikislearning
# export KAGGLE_KEY=xxxxxxxxxxxxxx
## CUDA
if [[ $(hostname) == 'erik-Desktop' ]]; then
	export PATH=/usr/local/cuda-9.0/bin:${PATH}
	export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/local/cuda-9.0/lib64
fi

## OLD {{{
## export GIO_EXTRA_MODULES=/usr/lib/x86_64-linux-gnu/gio/modules/

## Matlab
## export PATH=/usr/local/MATLAB/R2017b/bin:${PATH}

## GO
## export GOROOT=/home/erik/go
## export GOPATH=/home/erik/gopath
## export PATH=$GOROOT/bin:${PATH}

## # QT
## export QT_VERSION="5.10.1"
## export QT_DIR=$HOME/Qt
## export QT_STUB="false"
## export QT_DEBUG="false"
## }}}
## }}}

###==== TMUX {{{
if [ "$TMUX" = "" ]; then 
	tmux new
fi
###}}}

##==== ZSH Theme {{{
export ZSH=$HOME/.oh-my-zsh
ZSH_THEME="spaceship"
plugins=(vi-mode zsh-autosuggestions)
source $ZSH/oh-my-zsh.sh
## I believe npm install of spaceship makes the line below obsolete..
#bindkey '^ ' autosuggest-accept

# Spaceship {{{
# VI_MODE
SPACESHIP_VI_MODE_PREFIX=""
SPACESHIP_VI_MODE_SUFFIX=" "
SPACESHIP_VI_MODE_INSERT="[I]"
SPACESHIP_VI_MODE_NORMAL="[N]"
SPACESHIP_VI_MODE_COLOR=""

if [[ $(hostname) == 'erik-Desktop' ]]; then
	# NO battery
	SPACESHIP_PROMPT_ORDER=(
	time          # Time stampts section
	user          # Username section
	host          # Hostname section
	dir           # Current directory section
	git           # Git section (git_branch + git_status)
	hg            # Mercurial section (hg_branch  + hg_status)
	package       # Package version
	node          # Node.js section
	ruby          # Ruby section
	elixir        # Elixir section
	xcode         # Xcode section
	swift         # Swift section
	golang        # Go section
	php           # PHP section
	rust          # Rust section
	haskell       # Haskell Stack section
	julia         # Julia section
	docker        # Docker section
	aws           # Amazon Web Services section
	venv          # virtualenv section
	conda         # conda virtualenv section
	pyenv         # Pyenv section
	dotnet        # .NET section
	ember         # Ember.js section
	kubecontext   # Kubectl context section
	exec_time     # Execution time
	line_sep      # Line break
	jobs          # Backgound jobs indicator
	exit_code     # Exit code section
	vi_mode       # Vi-mode indicator
	char          # Prompt character
	)
else
	# With battery
	SPACESHIP_PROMPT_ORDER=(
	time          # Time stampts section
	user          # Username section
	host          # Hostname section
	dir           # Current directory section
	git           # Git section (git_branch + git_status)
	hg            # Mercurial section (hg_branch  + hg_status)
	package       # Package version
	node          # Node.js section
	ruby          # Ruby section
	elixir        # Elixir section
	xcode         # Xcode section
	swift         # Swift section
	golang        # Go section
	php           # PHP section
	rust          # Rust section
	haskell       # Haskell Stack section
	julia         # Julia section
	docker        # Docker section
	aws           # Amazon Web Services section
	venv          # virtualenv section
	conda         # conda virtualenv section
	pyenv         # Pyenv section
	dotnet        # .NET section
	ember         # Ember.js section
	kubecontext   # Kubectl context section
	exec_time     # Execution time
	line_sep      # Line break
	battery       # Battery level and status
	jobs          # Backgound jobs indicator
	exit_code     # Exit code section
	vi_mode       # Vi-mode indicator
	char          # Prompt character
	)

fi
#}}}
#}}}

# Color in Less Pager {{{
export LESS_TERMCAP_mb=$'\E[1;31m'     # begin bold
export LESS_TERMCAP_md=$'\E[1;36m'     # begin blink
export LESS_TERMCAP_me=$'\E[0m'        # reset bold/blink
export LESS_TERMCAP_so=$'\E[01;44;33m' # begin reverse video
export LESS_TERMCAP_se=$'\E[0m'        # reset reverse video
export LESS_TERMCAP_us=$'\E[1;32m'     # begin underline
export LESS_TERMCAP_ue=$'\E[0m'        # reset underline
export GROFF_NO_SGR=1                  # for konsole and gnome-terminal
#}}}

##==== Base16 {{{
#BASE16_SHELL=$HOME/.config/base16-shell/
#[ -n "$PS1" ] && [ -s $BASE16_SHELL/profile_helper.sh ] && eval "$($BASE16_SHELL/profile_helper.sh)"
##}}}

##==== FZF {{{
if [[ -f ~/.fzf.zsh  ]]; then
	source ~/.fzf.zsh
fi

export FZF_DEFAULT_OPTS='--height 40% --reverse'
export FZF_DEFAULT_COMMAND='fd --type f --hidden --exclude ".git"'  
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_ALT_C_COMMAND='fd --type d --hidden --exclude ".git"'  

export FZF_COMPLETION_OPTS='+c -x'
export FZF_CTRL_R_OPTS="--reverse"
export FZF_CTRL_T_OPTS="--preview '(highlight -O ansi -l {} 2> /dev/null || cat {} || tree -C {}) 2> /dev/null | head -200'"
export FZF_ALT_C_OPTS="--preview '(highlight -O ansi -l {} 1> /dev/null || cat {} || tree -C {}) 2> /dev/null | head -200'"
#}}}

## Alias & functions {{{

if [ -f ~/.files/zsh/zsh-functions.zsh ]; then
    source ~/.files/zsh/zsh-functions.zsh
else
    echo "404: ~/.files/zsh/zsh-functions.zsh not found."
fi

if [ -f ~/.files/zsh/aliases.zsh ]; then
    source ~/.files/zsh/aliases.zsh
else
    print "404: ~/.files/zsh/aliases.zsh not found."
fi

if [ -f .oh-my-zsh/custom/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh ]; then
	source .oh-my-zsh/custom/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh
fi

if [ -f $HOME/.oh-my-zsh/custom/themes/spaceship.zsh-theme ]; then
	source "$HOME/.oh-my-zsh/custom/themes/spaceship.zsh-theme"
fi

source ~/.files/tmuxinator/tmuxinator.zsh
source ~/.files/tmux/tmux_functions.zsh  # For my custom scripts

# }}}

